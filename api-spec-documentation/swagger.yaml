openapi: 3.0.0
info:
  title: LPX API
  version: "3.4"
servers:
- url: https://api.lpx-dev.arqiva-cs.com
paths:
  /events/{id}:
    get:
      summary: Select Event
      parameters:
      - name: id
        in: path
        description: ID of the item to fetch
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Event details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
        "404":
          description: Event not found
      x-amazon-apigateway-integration:
        type: aws_proxy
        uri: "arn:aws:apigateway:${base_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${base_region}:${aws_account_id}:function:${environment}-select_event/invocations"
        httpMethod: POST
        credentials: "arn:aws:iam::${aws_account_id}:role/${environment}-select_event-invokelambdarole"
        passthroughBehavior: when_no_match
        timeoutInMillis: 5000
    put:
      summary: Update Event
      parameters:
      - name: id
        in: path
        description: ID of the item to fetch
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Event'
        required: true
      responses:
        "200":
          description: Event updated
        "404":
          description: Event not found
      x-amazon-apigateway-integration:
        type: aws_proxy
        uri: "arn:aws:apigateway:${base_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${base_region}:${aws_account_id}:function:${environment}-update_event/invocations"
        httpMethod: POST
        credentials: "arn:aws:iam::${aws_account_id}:role/${environment}-update_event-invokelambdarole"
        passthroughBehavior: when_no_match
        timeoutInMillis: 5000
    delete:
      summary: Delete Event
      parameters:
      - name: id
        in: path
        description: ID of the item to fetch
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Event deleted
        "404":
          description: Event not found
      x-amazon-apigateway-integration:
        type: aws_proxy
        uri: "arn:aws:apigateway:${base_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${base_region}:${aws_account_id}:function:${environment}-delete_event/invocations"
        httpMethod: POST
        credentials: "arn:aws:iam::${aws_account_id}:role/${environment}-delete_event-invokelambdarole"
        passthroughBehavior: when_no_match
        timeoutInMillis: 5000
  /events:
    post:
      summary: Create Event
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Event'
        required: true
      responses:
        "201":
          description: Event created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inlineresponse201'
        "400":
          description: Invalid input
      x-amazon-apigateway-integration:
        type: aws_proxy
        uri: "arn:aws:apigateway:${base_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${base_region}:${aws_account_id}:function:${environment}-create_event/invocations"
        httpMethod: POST
        credentials: "arn:aws:iam::${aws_account_id}:role/${environment}-create_event-invokelambdarole"
        passthroughBehavior: when_no_match
        timeoutInMillis: 5000
  /events/share_event:
    post:
      summary: Share Event
      parameters:
      - name: id
        in: query
        description: Event id
        required: true
        style: form
        explode: true
        schema:
          type: string
      - name: user_id
        in: query
        description: The id of the user to share with - specific user or can take
          All to grant every one access
        required: true
        style: form
        explode: true
        schema:
          type: string
          default: All
      - name: share
        in: query
        description: Indicates to add a share or remove a share
        required: true
        style: form
        explode: true
        schema:
          type: boolean
          default: true
      responses:
        "200":
          description: Event shared successfully
        "400":
          description: Invalid input
        "404":
          description: Event or user not found
      x-amazon-apigateway-integration:
        type: aws_proxy
        uri: "arn:aws:apigateway:${base_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${base_region}:${aws_account_id}:function:${environment}-share_event/invocations"
        httpMethod: POST
        credentials: "arn:aws:iam::${aws_account_id}:role/${environment}-share_event-invokelambdarole"
        passthroughBehavior: when_no_match
        timeoutInMillis: 5000
  /events/list:
    get:
      summary: List Events
      responses:
        "200":
          description: An array of events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Event'
      x-amazon-apigateway-integration:
        type: aws_proxy
        uri: "arn:aws:apigateway:${base_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${base_region}:${aws_account_id}:function:${environment}-list_events/invocations"
        httpMethod: POST
        credentials: "arn:aws:iam::${aws_account_id}:role/${environment}-list_events-invokelambdarole"
        passthroughBehavior: when_no_match
        timeoutInMillis: 5000
components:
  schemas:
    Event:
      required:
      - eventdetails
      - uri
      type: object
      properties:
        uri:
          type: string
        type:
          type: string
          enum:
          - text
          - audio
          - video
          - picture
          - graphic
          - composite
          - component
          - event
          - planning
        representationtype:
          type: string
          enum:
          - full
          - partial
        profile:
          type: string
        version:
          type: string
        versioncreated:
          type: string
          format: date-time
        contentcreated:
          type: string
          format: date-time
        embargoed:
          type: string
          format: date-time
        urgency:
          type: number
        copyrightholder:
          type: string
        copyrightnotice:
          type: string
        usageterms:
          type: string
        ednote:
          type: string
        language:
          type: string
        descriptions:
          type: array
          items:
            $ref: '#/components/schemas/Event_descriptions'
        bodies:
          type: array
          items:
            $ref: '#/components/schemas/Event_bodies'
        headlines:
          type: array
          items:
            $ref: '#/components/schemas/Event_descriptions'
        people:
          type: array
          items:
            $ref: '#/components/schemas/Event_people'
        organisations:
          type: array
          items:
            $ref: '#/components/schemas/organisationType'
        places:
          type: array
          items:
            $ref: '#/components/schemas/Event_people'
        subjects:
          type: array
          items:
            $ref: '#/components/schemas/Event_subjects'
        events:
          type: array
          items:
            $ref: '#/components/schemas/Event_events'
        eventdetails:
          $ref: '#/components/schemas/Event_eventdetails'
        plannedcoverage:
          type: array
          items:
            $ref: '#/components/schemas/Event_plannedcoverage'
        objects:
          type: array
          items:
            $ref: '#/components/schemas/Event_objects'
        infosources:
          type: array
          items:
            $ref: '#/components/schemas/Event_infosources'
        title:
          type: string
        by:
          type: string
        slugline:
          type: string
        located:
          type: string
        renditions:
          type: array
          items:
            $ref: '#/components/schemas/renditionType'
        associations:
          type: array
          items:
            additionalProperties: false
            allOf:
            - $ref: '#/components/schemas/Event'
            - required:
              - name
              - uri
              type: object
              properties:
                name:
                  type: string
                  description: Name of associated object
        altids:
          type: array
          items:
            $ref: '#/components/schemas/Event_altids'
        trustindicators:
          type: array
          items:
            $ref: '#/components/schemas/Event_trustindicators'
        standard:
          $ref: '#/components/schemas/Event_standard'
        genres:
          type: array
          items:
            $ref: '#/components/schemas/Event_genres'
        expires:
          type: string
          format: date-time
        rightsinfo:
          $ref: '#/components/schemas/Event_rightsinfo'
    inlineresponse201:
      type: object
      properties:
        id:
          type: string
          description: The ID of the created event
    renditionType:
      required:
      - name
      type: object
      properties:
        name:
          type: string
        uri:
          type: string
          format: uri
        version:
          type: integer
        versionguid:
          type: string
        href:
          type: string
          format: uri
        code:
          type: string
        signal:
          type: string
        transportprotocol:
          type: string
          enum:
          - srtlistener
          - srtcaller
        maxbitrate:
          type: number
        cidr:
          type: string
        port:
          maximum: 65535
          exclusiveMaximum: true
          minimum: 1024
          type: number
        srtpassword:
          type: string
        listeneraddress:
          type: string
        streamid:
          type: string
        minlatency:
          type: number
        scantype:
          type: string
          enum:
          - progressive
          - interlaced
        bitrate:
          type: number
        gop:
          type: number
        ratecontrolmode:
          type: string
          enum:
          - CBR
          - VBR
          - QVBR
        contenttype:
          type: string
        title:
          type: string
        generated:
          type: string
          format: date-time
        height:
          type: number
        width:
          type: number
        sizeinbytes:
          type: number
        duration:
          type: number
        averagebitrate:
          type: number
        format:
          type: string
        originalfilename:
          type: string
        fileextension:
          type: string
        digest:
          type: string
        samplerate:
          type: number
        audiochannels:
          type: number
        audiobitrate:
          type: number
        aspectratio:
          type: string
        colourspace:
          type: string
        backgroundcolour:
          type: string
        orientation:
          type: string
        videocodec:
          type: string
        videoscaling:
          type: string
        framerate:
          type: number
        audiocodec:
          type: string
        scene:
          type: string
        printsize:
          type: number
        poi:
          $ref: '#/components/schemas/renditionType_poi'
      additionalProperties: false
    commissionedType:
      type: object
      properties:
        by:
          type: string
        "true":
          type: string
          format: date-time
        references:
          type: array
          items:
            $ref: '#/components/schemas/commissionedType_references'
      additionalProperties: false
    truncatedDateTimeType:
      type: string
    contactinfoType:
      type: object
      properties:
        type:
          type: string
        role:
          type: string
        lang:
          type: string
        name:
          type: string
        value:
          type: string
        address:
          $ref: '#/components/schemas/contactinfoType_address'
      additionalProperties: false
      oneOf:
      - required:
        - value
      - required:
        - address
    datesobjectType:
      type: object
      properties:
        startdate:
          $ref: '#/components/schemas/truncatedDateTimeType'
        enddate:
          $ref: '#/components/schemas/truncatedDateTimeType'
        duration:
          type: string
        recurrence:
          $ref: '#/components/schemas/datesobjectType_recurrence'
      additionalProperties: false
    organisationType:
      type: object
      properties:
        name:
          type: string
        rel:
          type: string
        uri:
          type: string
          format: uri
        literal:
          type: string
        symbols:
          type: array
          items:
            $ref: '#/components/schemas/organisationType_symbols'
        contactinfo:
          type: array
          items:
            $ref: '#/components/schemas/contactinfoType'
      additionalProperties: false
    Event_descriptions:
      required:
      - value
      type: object
      properties:
        role:
          type: string
        contenttype:
          type: string
        value:
          type: string
      additionalProperties: false
    Event_bodies:
      required:
      - value
      type: object
      properties:
        role:
          type: string
        contenttype:
          type: string
        charcount:
          type: integer
        wordcount:
          type: integer
        value:
          type: string
      additionalProperties: false
    Event_people:
      type: object
      properties:
        name:
          type: string
        rel:
          type: string
        uri:
          type: string
          format: uri
        literal:
          type: string
        contactinfo:
          type: array
          items:
            $ref: '#/components/schemas/contactinfoType'
      additionalProperties: false
    Event_subjects:
      type: object
      properties:
        name:
          type: string
        rel:
          type: string
        uri:
          type: string
          format: uri
        literal:
          type: string
        creator:
          type: string
        relevance:
          maximum: 100
          minimum: 0
          type: integer
          format: int32
        confidence:
          maximum: 100
          minimum: 0
          type: integer
          format: int32
      additionalProperties: false
    Event_events:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        rel:
          type: string
        uri:
          type: string
          format: uri
        literal:
          type: string
      additionalProperties: false
    Event_eventdetails:
      type: object
      properties:
        eventstatus:
          type: string
          enum:
          - pre-event
          - mid-event
          - post-event
          - postponed
          - suspended
          - halted
          - forfeited
          - rescheduled
          - delayed
          - canceled
          - intermission
          - if-necessary
          - discarded
        dates:
          $ref: '#/components/schemas/datesobjectType'
        organiser:
          $ref: '#/components/schemas/organisationType'
      additionalProperties: false
    Event_audiences:
      type: object
      properties:
        audience:
          type: string
        significance:
          type: integer
          format: int32
      additionalProperties: false
    Event_itemcount:
      type: object
      properties:
        rangefrom:
          type: integer
          format: int32
        rangeto:
          type: integer
          format: int32
    Event_plannedcoverage:
      type: object
      properties:
        uri:
          type: string
        title:
          type: string
        pubstatus:
          type: string
          enum:
          - usable
          - withheld
          - canceled
        commissioned:
          $ref: '#/components/schemas/commissionedType'
        dates:
          $ref: '#/components/schemas/datesobjectType'
        type:
          type: string
        event:
          type: string
        audiences:
          type: array
          items:
            $ref: '#/components/schemas/Event_audiences'
        exclaudience:
          type: array
          items:
            type: string
        headline:
          type: string
        ednote:
          type: string
        urgency:
          type: string
        language:
          type: string
        scheduled:
          type: string
        services:
          type: array
          items:
            type: string
        assignedto:
          type: string
        itemcount:
          $ref: '#/components/schemas/Event_itemcount'
        wordcount:
          type: integer
          format: int32
        renditions:
          type: array
          items:
            $ref: '#/components/schemas/renditionType'
    Event_objects:
      type: object
      properties:
        name:
          type: string
        rel:
          type: string
        uri:
          type: string
          format: uri
        literal:
          type: string
      additionalProperties: false
    Event_infosources:
      type: object
      properties:
        name:
          type: string
        role:
          type: string
        uri:
          type: string
          format: uri
        literal:
          type: string
        contactinfo:
          type: array
          items:
            $ref: '#/components/schemas/contactinfoType'
      additionalProperties: false
    Event_altids:
      type: object
      properties:
        role:
          type: string
          description: The role of the alternative id
        value:
          type: string
          description: The alternative id value
      additionalProperties: false
    Event_trustindicators:
      type: object
      properties:
        role:
          type: string
          format: uri
        title:
          type: string
        href:
          type: string
          format: uri
      additionalProperties: false
    Event_standard:
      type: object
      properties:
        name:
          type: string
        version:
          type: string
        schema:
          type: string
          format: uri
      additionalProperties: false
    Event_genres:
      type: object
      properties:
        name:
          type: string
        uri:
          type: string
        literal:
          type: string
      additionalProperties: false
    Event_rightsinfo:
      type: object
      properties:
        langid:
          type: string
          format: uri
        linkedrights:
          type: string
          format: uri
        encodedrights:
          type: string
    renditionType_poi:
      type: object
      properties:
        x:
          type: integer
        "y":
          type: integer
    commissionedType_references:
      type: object
      properties:
        name:
          type: string
        value:
          type: string
      additionalProperties: false
    contactinfoType_address:
      type: object
      properties:
        lines:
          type: array
          items:
            type: string
        locality:
          type: string
        area:
          type: string
        postalcode:
          type: string
        country:
          type: string
      additionalProperties: false
    datesobjectType_recurrence_recurrencerules:
      type: object
      properties:
        frequency:
          type: string
          enum:
          - secondly
          - minutely
          - hourly
          - daily
          - weekly
          - monthly
          - yearly
        interval:
          type: string
        until:
          type: string
        count:
          type: string
      additionalProperties: false
    datesobjectType_recurrence:
      type: object
      properties:
        recurrence-dates:
          type: array
          items:
            $ref: '#/components/schemas/truncatedDateTimeType'
        recurrence-rules:
          type: array
          items:
            $ref: '#/components/schemas/datesobjectType_recurrence_recurrencerules'
    organisationType_symbols:
      type: object
      properties:
        ticker:
          type: string
        exchange:
          type: string
        symboltype:
          type: string
          format: uri
        symbol:
          type: string
      additionalProperties: false
  securitySchemes:
    api-key:
      type: apiKey
      name: x-api-key
      in: header
      x-amazon-apigateway-api-key-source: HEADER
